<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AuthenticationScreen.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.serenityai.ui.screens</a> &gt; <span class="el_source">AuthenticationScreen.kt</span></div><h1>AuthenticationScreen.kt</h1><pre class="source lang-java linenums">package com.serenityai.ui.screens

import androidx.compose.foundation.layout.*
import androidx.compose.foundation.text.KeyboardOptions
import androidx.compose.material.icons.Icons
import androidx.compose.material.icons.filled.*
import androidx.compose.material3.*
import androidx.compose.runtime.*
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.text.font.FontWeight
import androidx.compose.ui.text.input.KeyboardType
import androidx.compose.ui.text.input.PasswordVisualTransformation
import androidx.compose.ui.text.input.VisualTransformation
import androidx.compose.ui.text.style.TextAlign
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import kotlinx.coroutines.delay
import androidx.compose.runtime.LaunchedEffect

@Composable
fun AuthenticationScreen(
    onLoginSuccess: () -&gt; Unit,
    onSignUpSuccess: () -&gt; Unit
<span class="nc bnc" id="L25" title="All 14 branches missed.">) {</span>
<span class="nc" id="L26">    var isLoginMode by remember { mutableStateOf(true) }</span>
<span class="nc" id="L27">    var email by remember { mutableStateOf(&quot;&quot;) }</span>
<span class="nc" id="L28">    var password by remember { mutableStateOf(&quot;&quot;) }</span>
<span class="nc" id="L29">    var confirmPassword by remember { mutableStateOf(&quot;&quot;) }</span>
<span class="nc" id="L30">    var passwordVisible by remember { mutableStateOf(false) }</span>
<span class="nc" id="L31">    var isLoading by remember { mutableStateOf(false) }</span>
<span class="nc" id="L32">    var errorMessage by remember { mutableStateOf(&quot;&quot;) }</span>
<span class="nc" id="L33">    var shouldAuthenticate by remember { mutableStateOf(false) }</span>
<span class="nc" id="L34">    var isSignUp by remember { mutableStateOf(false) }</span>
    
    // Handle authentication with LaunchedEffect
<span class="nc bnc" id="L37" title="All 4 branches missed.">    LaunchedEffect(shouldAuthenticate) {</span>
<span class="nc bnc" id="L38" title="All 2 branches missed.">        if (shouldAuthenticate) {</span>
<span class="nc" id="L39">            delay(1000) // Simulate network delay</span>
<span class="nc" id="L40">            isLoading = false</span>
<span class="nc" id="L41">            shouldAuthenticate = false</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">            if (isSignUp) {</span>
<span class="nc" id="L43">                onSignUpSuccess()</span>
            } else {
<span class="nc" id="L45">                onLoginSuccess()</span>
            }
        }
<span class="nc" id="L48">    }</span>
    
<span class="nc" id="L50">    Column(</span>
<span class="nc" id="L51">        modifier = Modifier</span>
<span class="nc" id="L52">            .fillMaxSize()</span>
<span class="nc" id="L53">            .padding(24.dp),</span>
<span class="nc" id="L54">        horizontalAlignment = Alignment.CenterHorizontally,</span>
<span class="nc" id="L55">        verticalArrangement = Arrangement.Center</span>
    ) {
        // Header
<span class="nc" id="L58">        Text(</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">            text = if (isLoginMode) &quot;Welcome Back&quot; else &quot;Create Account&quot;,</span>
<span class="nc" id="L60">            fontSize = 28.sp,</span>
<span class="nc" id="L61">            fontWeight = FontWeight.Bold,</span>
<span class="nc" id="L62">            textAlign = TextAlign.Center</span>
        )
        
<span class="nc" id="L65">        Spacer(modifier = Modifier.height(8.dp))</span>
        
<span class="nc" id="L67">        Text(</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">            text = if (isLoginMode) &quot;Sign in to continue your journey&quot; else &quot;Join us for better mental health&quot;,</span>
<span class="nc" id="L69">            fontSize = 16.sp,</span>
<span class="nc" id="L70">            color = MaterialTheme.colorScheme.onSurface.copy(alpha = 0.7f),</span>
<span class="nc" id="L71">            textAlign = TextAlign.Center</span>
        )
        
<span class="nc" id="L74">        Spacer(modifier = Modifier.height(32.dp))</span>
        
        // Email Field
<span class="nc" id="L77">        OutlinedTextField(</span>
<span class="nc" id="L78">            value = email,</span>
<span class="nc" id="L79">            onValueChange = { email = it },</span>
<span class="nc bnc" id="L80" title="All 8 branches missed.">            label = { Text(&quot;Email&quot;) },</span>
<span class="nc bnc" id="L81" title="All 8 branches missed.">            leadingIcon = { Icon(Icons.Default.Email, contentDescription = null) },</span>
<span class="nc" id="L82">            keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Email),</span>
<span class="nc" id="L83">            modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L84">            singleLine = true</span>
        )
        
<span class="nc" id="L87">        Spacer(modifier = Modifier.height(16.dp))</span>
        
        // Password Field
<span class="nc" id="L90">        OutlinedTextField(</span>
<span class="nc" id="L91">            value = password,</span>
<span class="nc" id="L92">            onValueChange = { password = it },</span>
<span class="nc bnc" id="L93" title="All 8 branches missed.">            label = { Text(&quot;Password&quot;) },</span>
<span class="nc bnc" id="L94" title="All 8 branches missed.">            leadingIcon = { Icon(Icons.Default.Lock, contentDescription = null) },</span>
<span class="nc" id="L95">            trailingIcon = {</span>
<span class="nc bnc" id="L96" title="All 10 branches missed.">                IconButton(onClick = { passwordVisible = !passwordVisible }) {</span>
<span class="nc bnc" id="L97" title="All 8 branches missed.">                    Icon(</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">                        if (passwordVisible) Icons.Default.VisibilityOff else Icons.Default.Visibility,</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">                        contentDescription = if (passwordVisible) &quot;Hide password&quot; else &quot;Show password&quot;</span>
<span class="nc" id="L100">                    )</span>
<span class="nc" id="L101">                }</span>
<span class="nc" id="L102">            },</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">            visualTransformation = if (passwordVisible) VisualTransformation.None else PasswordVisualTransformation(),</span>
<span class="nc" id="L104">            modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L105">            singleLine = true</span>
        )
        
        // Confirm Password Field (only for signup)
<span class="nc bnc" id="L109" title="All 2 branches missed.">        if (!isLoginMode) {</span>
<span class="nc" id="L110">            Spacer(modifier = Modifier.height(16.dp))</span>
            
<span class="nc" id="L112">            OutlinedTextField(</span>
<span class="nc" id="L113">                value = confirmPassword,</span>
<span class="nc" id="L114">                onValueChange = { confirmPassword = it },</span>
<span class="nc bnc" id="L115" title="All 8 branches missed.">                label = { Text(&quot;Confirm Password&quot;) },</span>
<span class="nc bnc" id="L116" title="All 8 branches missed.">                leadingIcon = { Icon(Icons.Default.Lock, contentDescription = null) },</span>
<span class="nc" id="L117">                visualTransformation = PasswordVisualTransformation(),</span>
<span class="nc" id="L118">                modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L119">                singleLine = true</span>
            )
        }
        
<span class="nc" id="L123">        Spacer(modifier = Modifier.height(24.dp))</span>
        
        // Error Message
<span class="nc bnc" id="L126" title="All 4 branches missed.">        if (errorMessage.isNotEmpty()) {</span>
<span class="nc" id="L127">            Card(</span>
<span class="nc" id="L128">                modifier = Modifier.fillMaxWidth(),</span>
<span class="nc" id="L129">                colors = CardDefaults.cardColors(</span>
<span class="nc" id="L130">                    containerColor = MaterialTheme.colorScheme.errorContainer</span>
                )
<span class="nc" id="L132">            ) {</span>
<span class="nc bnc" id="L133" title="All 8 branches missed.">                Text(</span>
<span class="nc" id="L134">                    text = errorMessage,</span>
<span class="nc" id="L135">                    color = MaterialTheme.colorScheme.onErrorContainer,</span>
<span class="nc" id="L136">                    modifier = Modifier.padding(16.dp),</span>
<span class="nc" id="L137">                    textAlign = TextAlign.Center</span>
<span class="nc" id="L138">                )</span>
<span class="nc" id="L139">            }</span>
<span class="nc" id="L140">            Spacer(modifier = Modifier.height(16.dp))</span>
        }
        
        // Submit Button
<span class="nc" id="L144">        Button(</span>
<span class="nc" id="L145">            onClick = {</span>
<span class="nc" id="L146">                when {</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">                    email.isBlank() -&gt; errorMessage = &quot;Please enter your email&quot;</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">                    password.isBlank() -&gt; errorMessage = &quot;Please enter your password&quot;</span>
<span class="nc bnc" id="L149" title="All 4 branches missed.">                    !isLoginMode &amp;&amp; password != confirmPassword -&gt; errorMessage = &quot;Passwords do not match&quot;</span>
                    else -&gt; {
<span class="nc" id="L151">                        isLoading = true</span>
<span class="nc" id="L152">                        errorMessage = &quot;&quot;</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">                        isSignUp = !isLoginMode</span>
<span class="nc" id="L154">                        shouldAuthenticate = true</span>
                    }
                }
<span class="nc" id="L157">            },</span>
<span class="nc" id="L158">            modifier = Modifier.fillMaxWidth(),</span>
<span class="nc bnc" id="L159" title="All 2 branches missed.">            enabled = !isLoading</span>
<span class="nc" id="L160">        ) {</span>
<span class="nc bnc" id="L161" title="All 8 branches missed.">            if (isLoading) {</span>
<span class="nc" id="L162">                CircularProgressIndicator(</span>
<span class="nc" id="L163">                    modifier = Modifier.size(20.dp),</span>
<span class="nc" id="L164">                    color = MaterialTheme.colorScheme.onPrimary</span>
                )
<span class="nc bnc" id="L166" title="All 2 branches missed.">            } else {</span>
<span class="nc" id="L167">                Text(</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">                    text = if (isLoginMode) &quot;Sign In&quot; else &quot;Sign Up&quot;,</span>
<span class="nc" id="L169">                    fontSize = 16.sp</span>
                )
<span class="nc" id="L171">            }</span>
<span class="nc" id="L172">        }</span>
        
<span class="nc" id="L174">        Spacer(modifier = Modifier.height(16.dp))</span>
        
        // Toggle Mode
<span class="nc" id="L177">        TextButton(</span>
<span class="nc" id="L178">            onClick = {</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">                isLoginMode = !isLoginMode</span>
<span class="nc" id="L180">                errorMessage = &quot;&quot;</span>
<span class="nc" id="L181">                email = &quot;&quot;</span>
<span class="nc" id="L182">                password = &quot;&quot;</span>
<span class="nc" id="L183">                confirmPassword = &quot;&quot;</span>
<span class="nc" id="L184">            }</span>
<span class="nc" id="L185">        ) {</span>
<span class="nc bnc" id="L186" title="All 8 branches missed.">            Text(</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">                text = if (isLoginMode) &quot;Don't have an account? Sign Up&quot; else &quot;Already have an account? Sign In&quot;,</span>
<span class="nc" id="L188">                color = MaterialTheme.colorScheme.primary</span>
<span class="nc" id="L189">            )</span>
<span class="nc" id="L190">        }</span>
        
<span class="nc" id="L192">        Spacer(modifier = Modifier.height(16.dp))</span>
        
        // Forgot Password (only for login)
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (isLoginMode) {</span>
<span class="nc" id="L196">            TextButton(onClick = { /* Handle forgot password */ }) {</span>
<span class="nc bnc" id="L197" title="All 8 branches missed.">                Text(</span>
<span class="nc" id="L198">                    text = &quot;Forgot Password?&quot;,</span>
<span class="nc" id="L199">                    color = MaterialTheme.colorScheme.primary</span>
<span class="nc" id="L200">                )</span>
<span class="nc" id="L201">            }</span>
        }
<span class="nc" id="L203">    }</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>